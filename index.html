<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expertisekosten Calculator</title>
</head>
<body>

    <div>
        <h1>Expertisekosten Calculator</h1>

        <label for="verzekeringsmaatschappij">Verzekeringsmaatschappij:</label>
        <select id="verzekeringsmaatschappij">
            <option value="AG Insurance">AG Insurance</option>
            <option value="Ethias">Ethias</option>
            <!-- Voeg hier andere verzekeringsmaatschappijen toe -->
        </select>

        <label for="vergoeding">Bedrag van de vergoeding:</label>
        <input type="text" id="vergoeding" placeholder="Bedrag in Euro" oninput="this.value = this.value.replace(/[^0-9.]/g, '');">

        <button onclick="berekenExpertisekosten()">Bereken Expertisekosten</button>

        <p id="resultaat"></p>
    </div>

    <script>
        // Functie om expertisekosten te berekenen
        function berekenExpertisekosten() {
            var maatschappij = document.getElementById("verzekeringsmaatschappij").value;
            var vergoeding = parseFloat(document.getElementById("vergoeding").value);

            // Haal de expertisekosten op uit het CSV-bestand voor de geselecteerde maatschappij
            fetch('verzekeringsmaatschappijen.csv')
                .then(response => response.text())
                .then(data => {
                    // Verwerk de CSV-gegevens
                    var rows = data.split('\n');
                    var expertisekosten;
                    for (var i = 1; i < rows.length; i++) { // Begin bij 1 om de koptekst over te slaan
                        var columns = rows[i].split(',');
                        if (columns[0] === maatschappij) {
                            expertisekosten = berekenExpertisekostenVolgensTarieven(columns, vergoeding);
                            break;
                        }
                    }
                    if (expertisekosten) {
                        document.getElementById("resultaat").innerText = "Expertisekosten bij " + maatschappij + ": " + expertisekosten.toFixed(2) + " Euro";
                    } else {
                        document.getElementById("resultaat").innerText = "Tarieven voor deze maatschappij niet gevonden.";
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    document.getElementById("resultaat").innerText = "Er is een fout opgetreden bij het verwerken van het CSV-bestand.";
                });
        }

        // Functie om expertisekosten te berekenen volgens tarieven uit het CSV-bestand
        function berekenExpertisekostenVolgensTarieven(tarieven, vergoeding) {
            if (vergoeding <= parseInt(tarieven[1])) {
                return (vergoeding * parseFloat(tarieven[2])).toFixed(2);
            } else if (vergoeding <= parseInt(tarieven[3])) {
                return (parseInt(tarieven[1]) * parseFloat(tarieven[2]) + (vergoeding - parseInt(tarieven[1])) * parseFloat(tarieven[4])).toFixed(2);
            } else {
                return (parseInt(tarieven[1]) * parseFloat(tarieven[2]) + (parseInt(tarieven[3]) - parseInt(tarieven[1])) * parseFloat(tarieven[4]) + (vergoeding - parseInt(tarieven[3])) * parseFloat(tarieven[5])).toFixed(2);
            }
        }
    </script>

</body>
</html>
